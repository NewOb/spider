#针对ajax异步加载的数据需要抓包分析# 爬取腾讯视频的评论# 评论url# https://video.coral.qq.com/varticle/4192549294/comment/v2?callback=_varticle4192549294commentv2&orinum=10&oriorder=o&pageflag=1&cursor=0&scorecursor=0&orirepnum=2&reporder=o&reppageflag=1&source=132&_=1569000362584# https://video.coral.qq.com/varticle/4192549294/comment/v2?callback=_varticle4192549294commentv2&orinum=10&oriorder=o&pageflag=1&cursor=6580855336490999900&scorecursor=0&orirepnum=2&reporder=o&reppageflag=1&source=132&_=1568998336957# https://video.coral.qq.com/varticle/4192549294/comment/v2?callback=_varticle4192549294commentv2&orinum=10&oriorder=o&pageflag=1&cursor=6580429321215430580&scorecursor=0&orirepnum=2&reporder=o&reppageflag=1&source=132&_=1568998336958from IPUA_spider import *import emoji# url = "https://video.coral.qq.com/varticle/4192549294/comment/v2?callback=_varticle4192549294commentv2&orinum=10&oriorder=o&pageflag=1&cursor="+str(i)+"&scorecursor=0&orirepnum=2&reporder=o&reppageflag=1&source=132&_=1569000362584"# datapage = get_HTML(url)# nextpage = '"last":"(.*?)"'# contentPat = '"content":"(.*?)"'# content = get_content(url,contentPat)# i = get_content(url,nextpage)# print(datapage)fh = open("E:\\测试下载文档\\中餐厅_腾讯视频评论\\评论.txt","w")i=0while 1:    url = "https://video.coral.qq.com/varticle/4192549294/comment/v2?callback=_varticle4192549294commentv2&orinum=10&oriorder=o&pageflag=1&cursor=" + str(i) + "&scorecursor=0&orirepnum=2&reporder=o&reppageflag=1&source=132&_=1569000362584"    contentPat = '"content":"(.*?)"'    content = get_content(url, contentPat)    # print(content)    for p in content:        q = emoji.demojize(p)+"\n"+"-"*20+"\n"        print(q)        try:            fh.write(q)        except Exception as e:            print("出现错误："+str(e))            time.sleep(5)        # write_file("E:\\测试下载文档\\中餐厅_腾讯视频评论\\评论.txt",q)    # data_page = get_HTML(url)    next_page = '"last":"(.*?)"'    i = get_content(url, next_page)[0]    if i:        print(i)    else:        fh.close()        print("爬取结束")        break